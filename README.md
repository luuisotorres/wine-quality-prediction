# 🍷 Wine Quality Prediction App

[![Streamlit App](https://static.streamlit.io/badges/streamlit_badge_black_white.svg)](https://huggingface.co/spaces/luisotorres/wine-quality-predictions)
[![Python 3.9+](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

> An ML-powered application for predicting wine quality using physicochemical properties

## 📌 Table of Contents
- [Overview](#overview)
- [Features](#features)
- [Installation](#installation)
- [Usage](#usage)
- [Project Structure](#project-structure)
- [Model Details](#model-details)
- [Development](#development)
- [Contact](#contact)

## 🎯 Overview

This machine learning application, deployed on Hugging Face's Spaces, predicts wine quality based on various physicochemical properties. The model was trained on a dataset generated by a deep learning model based on the [Wine Quality Dataset](https://www.kaggle.com/datasets/yasserh/wine-quality-dataset).

## ✨ Features

The application analyzes the following wine properties:

<table>
  <tr>
    <th>Feature</th>
    <th>Description</th>
  </tr>
  <tr>
    <td><b>Fixed Acidity</b></td>
    <td>Amount of fixed acids (tartaric, malic acid)</td>
  </tr>
  <tr>
    <td><b>Volatile Acidity</b></td>
    <td>Amount of volatile acids (acetic acid)</td>
  </tr>
  <tr>
    <td><b>Citric Acid</b></td>
    <td>Organic acid found in citrus fruits, adds tangy flavor</td>
  </tr>
  <tr>
    <td><b>Residual Sugar</b></td>
    <td>Amount of unfermented sugar affecting wine sweetness</td>
  </tr>
  <tr>
    <td><b>Chlorides</b></td>
    <td>Salt content in the wine</td>
  </tr>
  <tr>
    <td><b>Free Sulfur Dioxide</b></td>
    <td>Unreacted sulfur dioxide in wine</td>
  </tr>
  <tr>
    <td><b>Total Sulfur Dioxide</b></td>
    <td>Total amount of sulfur dioxide (free + bound forms)</td>
  </tr>
  <tr>
    <td><b>Density</b></td>
    <td>Correlation between alcohol content and grape types</td>
  </tr>
  <tr>
    <td><b>pH</b></td>
    <td>Acidity or basicity measure</td>
  </tr>
  <tr>
    <td><b>Sulfates</b></td>
    <td>Preservation salt affecting taste</td>
  </tr>
  <tr>
    <td><b>Alcohol</b></td>
    <td>Alcohol percentage affecting flavor and body</td>
  </tr>
</table>

## 🚀 Installation

```bash
# Clone the repository
git clone https://github.com/luuisotorres/wine-quality-prediction.git
cd wine-quality-prediction

# Create a virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install dependencies
pip install -r requirements.txt
```

## 💻 Usage

```bash
# Run the Streamlit app locally
streamlit run app.py
```

Visit `http://localhost:8501` in your browser to use the application.

## 📁 Project Structure

```
wine-predictions/
├── app.py                                          # Main Streamlit application
├── requirements.txt                                # Project dependencies
├── wine-quality-eda-prediction-and-deploy.ipynb    # Notebook with EDA and model development
├── wine_quality_prediction.pkl                     # PKL model
└── README.md                                       # Project documentation
```

## 🤖 Model Details

The prediction model uses a sophisticated pipeline that includes:

1. Data cleaning and preprocessing
2. Feature engineering and selection
3. Categorical encoding (OrdinalEncoder and OneHotEncoder)
4. Clustering
5. CatBoostClassifier (fine-tuned with Optuna)

### Model Performance

The model achieved a Quadratic Weighted Kappa (QWK) score of 0.53011 in the competition. The QWK score is calculated as:

$$
\kappa = 1 - \frac{\sum_{i,j} w_{ij} O_{ij}}{\sum_{i,j} w_{ij} E_{ij}}
$$

Where:
- $O_{ij}$ = actual confusion matrix
- $E_{ij}$ = expected confusion matrix under randomness
- $w_{ij}$ = weighted matrix, calculated as $(i - j)^2$

For detailed model development and analysis, check out the [Kaggle notebook](https://www.kaggle.com/code/lusfernandotorres/wine-quality-eda-prediction-and-deploy/notebook).

## 📫 Contact

👨🏻‍💻 **Luis Fernando Torres**

Let's connect! 🔗

[![LinkedIn](https://img.shields.io/badge/LinkedIn-0077B5?style=for-the-badge&logo=linkedin&logoColor=white)](https://www.linkedin.com/in/luuisotorres/)
[![Medium](https://img.shields.io/badge/Medium-12100E?style=for-the-badge&logo=medium&logoColor=white)](https://medium.com/@luuisotorres)
[![Kaggle](https://img.shields.io/badge/Kaggle-20BEFF?style=for-the-badge&logo=kaggle&logoColor=white)](https://www.kaggle.com/lusfernandotorres)
[![Hugging Face](https://img.shields.io/badge/_Hugging_Face-FFD21E?style=for-the-badge&logo=huggingface&logoColor=black)](https://huggingface.co/luisotorres)
